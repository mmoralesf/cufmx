define("js/utils/handle_iframe_binding",["jquery"],function(e){var t=function(t){var i=null;i="undefined"==typeof t?e("iframe, embed"):"undefined"!=typeof t.nodeName?e(t).find("iframe, embed"):t.$("iframe, embed"),n(i)},n=function(t){t.each(function(){if("IFRAME"===e(this).prop("tagName")){var t=e(this).attr("src");if(t){var n="wmode=transparent";if(-1!==t.indexOf("?")){var i=t.split("?");if(-1===i[1].search("wmode=transparent")){var o=i[1],s=i[0];e(this).attr("src",s+"?"+n+"&"+o)}}else 0!==t.lastIndexOf("javascript:",0)&&e(this).attr("src",t+"?"+n)}}else e(this).attr("wmode","transparent")})},i=function(t){if(t){var i=null,o=document.createElement("div");e(o).html(t),i=e(o).find("iframe, embed"),i.length>0&&(n(i),t=e(o).html())}return t};return{iframeBinding:t,iframeBindingHtml:i}}),define("js/utils/templates",["jquery","underscore"],function(e,t){var n=function(n){var i="#"+n+"-tpl",o=e(i).text();return o||console.error("Failed to load "+n+" template"),t.template(o)};return{loadTemplate:n}}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!common/templates/components/system-feedback.underscore",[],function(){return'<div class="wrapper wrapper-<%= type %> wrapper-<%= type %>-<%= intent %>\n            <% if(obj.shown) { %>is-shown<% } else { %>is-hiding<% } %>\n            <% if(_.contains([\'help\', \'mini\'], intent)) { %>wrapper-<%= type %>-status<% } %>"\n     id="<%= type %>-<%= intent %>"\n     aria-hidden="<% if(obj.shown) { %>false<% } else { %>true<% } %>"\n     aria-labelledby="<%= type %>-<%= intent %>-title"\n     tabindex="-1"\n     <% if (obj.message) { %>aria-describedby="<%= type %>-<%= intent %>-description" <% } %>\n     <% if (obj.actions) { %>role="dialog"<% } %>\n  >\n  <div class="<%= type %> <%= intent %> <% if(obj.actions) { %>has-actions<% } %>">\n    <% if(obj.icon) { %>\n      <% var iconClass = {"warning": "warning", "confirmation": "check", "error": "warning", "announcement": "bullhorn", "step-required": "exclamation-circle", "help": "question", "mini": "cog"} %>\n      <span class="feedback-symbol fa fa-<%= iconClass[intent] %>" aria-hidden="true"></span>\n    <% } %>\n\n    <div class="copy">\n      <h2 class="title title-3" id="<%= type %>-<%= intent %>-title"><%- title %></h2>\n      <% if(obj.message) { %><p class="message" id="<%= type %>-<%= intent %>-description"><%- message %></p><% } %>\n    </div>\n\n    <% if(obj.actions) { %>\n    <nav class="nav-actions">\n      <ul>\n        <% if(actions.primary) { %>\n        <li class="nav-item">\n          <button class="action-primary <%= actions.primary.class %>"><%- actions.primary.text %></button>\n        </li>\n        <% } %>\n        <% if(actions.secondary) {\n             _.each(actions.secondary, function(secondary) { %>\n        <li class="nav-item">\n          <button class="action-secondary <%= secondary.class %>"><%- secondary.text %></button>\n        </li>\n        <%   });\n           } %>\n      </ul>\n    </nav>\n    <% } %>\n\n    <% if(obj.closeIcon) { %>\n    <a href="#" rel="view" class="action action-close action-<%= type %>-close">\n      <span class="icon fa fa-times-circle" aria-hidden="true"></span>\n      <span class="label">close <%= type %></span>\n    </a>\n    <% } %>\n  </div>\n</div>\n'}),function(e){"use strict";e("common/js/components/views/feedback",["jquery","underscore","underscore.string","backbone","edx-ui-toolkit/js/utils/html-utils","text!../../../../common/templates/components/system-feedback.underscore"],function(e,t,n,i,o,s){var a=["a[href]:not([tabindex='-1'])","area[href]:not([tabindex='-1'])","input:not([disabled]):not([tabindex='-1'])","select:not([disabled]):not([tabindex='-1'])","textarea:not([disabled]):not([tabindex='-1'])","button:not([disabled]):not([tabindex='-1'])","iframe:not([tabindex='-1'])","[tabindex]:not([tabindex='-1'])","[contentEditable=true]:not([tabindex='-1'])"],r=i.View.extend({options:{title:"",message:"",intent:null,type:null,shown:!0,icon:!0,closeIcon:!0,minShown:0,maxShown:1/0,outFocusElement:null},initialize:function(n){if(this.options=t.extend({},this.options,n),!this.options.type)throw"SystemFeedback: type required (given "+JSON.stringify(this.options)+")";if(!this.options.intent)throw"SystemFeedback: intent required (given "+JSON.stringify(this.options)+")";return this.setElement(e("#page-"+this.options.type)),this.options.actions&&this.options.actions.secondary&&!t.isArray(this.options.actions.secondary)&&(this.options.actions.secondary=[this.options.actions.secondary]),this},inFocus:function(e){var t,n=e||".wrapper";return this.options.outFocusElement=this.options.outFocusElement||document.activeElement,this.$(n).first().focus(),t=this.$(a.join()),t.on("keydown",function(e){9===e.which&&e.shiftKey&&e.target===t.first()[0]?(e.preventDefault(),t.last().focus()):9!==e.which||e.shiftKey||e.target!==t.last()[0]||(e.preventDefault(),t.first().focus())}),this},outFocus:function(){return this.$(a.join()).off("keydown"),this.options.outFocusElement&&this.options.outFocusElement.focus(),this},show:function(){return clearTimeout(this.hideTimeout),this.options.shown=!0,this.shownAt=new Date,this.render(),e.isNumeric(this.options.maxShown)&&(this.hideTimeout=setTimeout(t.bind(this.hide,this),this.options.maxShown)),this},hide:function(){return this.shownAt&&e.isNumeric(this.options.minShown)&&this.options.minShown>new Date-this.shownAt?(clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(t.bind(this.hide,this),this.options.minShown-(new Date-this.shownAt))):(this.options.shown=!1,delete this.shownAt,this.render()),this},events:{"click .action-close":"hide","click .action-primary":"primaryClick","click .action-secondary":"secondaryClick"},render:function(){var e=r["active_"+this.options.type];return e&&e!==this&&(e.stopListening(),e.undelegateEvents()),o.setHtml(this.$el,o.template(s)(this.options)),r["active_"+this.options.type]=this,this},primaryClick:function(e){var t,n;t=this.options.actions,t&&(n=t.primary,n&&(n.preventDefault!==!1&&e.preventDefault(),n.click&&n.click.call(e.target,this,e)))},secondaryClick:function(e){var n,i,o,s;n=this.options.actions,n&&(i=n.secondary,i&&(s=0,e&&e.target&&(s=t.indexOf(this.$(".action-secondary"),e.target)),o=i[s],o.preventDefault!==!1&&e.preventDefault(),o.click&&o.click.call(e.target,this,e)))}});return r})}.call(this,define||RequireJS.define),function(e){"use strict";e("common/js/components/views/feedback_notification",["jquery","underscore","underscore.string","./feedback"],function(e,t,n,i){var o,s,a,r=i.extend({options:e.extend({},i.prototype.options,{type:"notification",closeIcon:!1})});return o=t.compose(n.capitalize,n.camelize),s=["warning","error","confirmation","announcement","step-required","help","mini"],t.each(s,function(t){var n;n=r.extend({options:e.extend({},r.prototype.options,{intent:t})}),r[o(t)]=n}),a=r.Mini.prototype.options,a.minShown=1250,a.closeIcon=!1,r})}.call(this,define||RequireJS.define),function(e){"use strict";e("common/js/components/views/feedback_prompt",["jquery","underscore","underscore.string","common/js/components/views/feedback"],function(e,t,n,i){var o,s,a=i.extend({options:e.extend({},i.prototype.options,{type:"prompt",closeIcon:!1,icon:!1}),render:function(){return window.$body||(window.$body=e(document.body)),this.options.shown?$body.addClass("prompt-is-shown"):$body.removeClass("prompt-is-shown"),i.prototype.render.apply(this,arguments)},show:function(){return i.prototype.show.apply(this,arguments),this.inFocus()},hide:function(){return i.prototype.hide.apply(this,arguments),this.outFocus()}});return o=t.compose(n.capitalize,n.camelize),s=["warning","error","confirmation","announcement","step-required","help","mini"],t.each(s,function(t){var n;n=a.extend({options:e.extend({},a.prototype.options,{intent:t})}),a[o(t)]=n}),a})}.call(this,define||RequireJS.define),function(e,t){"use strict";e("common/js/components/utils/view_utils",["jquery","underscore","gettext","common/js/components/views/feedback_notification","common/js/components/views/feedback_prompt"],function(e,n,i,o,s){var a,r,c,l,d,u,p,h,f,m,y,g,v,w,b,x,j,k,R,C=65;return a=function(e,t){t||(t="collapsed"),e.closest(".expand-collapse").toggleClass("expand collapse"),e.closest(".is-collapsible, .window").toggleClass(t),e.closest(".is-collapsible").children("article").slideToggle()},r=function(){e(".ui-loading").show()},c=function(){e(".ui-loading").hide()},l=function(e,t,n,o,a){return new s.Warning({title:e,message:t,actions:{primary:{text:n,click:function(e){e.hide(),o()}},secondary:{text:i("Cancel"),click:function(e){return a&&a(),e.hide()}}}}).show()},d=function(e,t){var n;return n=new o.Mini({title:i(e)}),n.show(),t().done(function(){n.hide()})},u=function(t){return function(n){var i=this;p(e(n.currentTarget),function(){return i[t].apply(i,[n])})}},p=function(e,t){return e.addClass("is-disabled").attr("aria-disabled",!0),t().always(function(){e.removeClass("is-disabled").attr("aria-disabled",!1)})},w=function(t){return function(n){n.preventDefault(),e.ajax({url:e(this).data("dismiss-link"),type:"DELETE",success:t})}},m=function(t){e("html, body").animate({scrollTop:t},500)},h=function(t){var n=t.offset().top;return n-e(window).scrollTop()},f=function(e,t){var n=e.offset().top,i=n-t;m(i)},y=function(e){window.location=e},g=function(){window.location.reload()},v=function(e,t){var i,o=e.changedAttributes();if(!o)return!1;for(i=0;i<t.length;i++)if(n.has(o,t[i]))return!0;return!1},b=function(e){return 0===e.length?i("Required field."):""},x=function(e,t){var n=b(e);if(n)return n;if(t){if(/\s/g.test(e))return i("Please do not use any spaces in this field.")}else if(e!==encodeURIComponent(e)||e.match(/[!'()*]/))return i("Please do not use any spaces or special characters in this field.");return""},j=function(t){var i=n.reduce(t,function(t,n){return t+e(n).val().length},0);return C>=i},k=function(t,i,o,s){j(o)?e(t.errorWrapper).removeClass(i.shown).addClass(i.hiding):(e(t.errorWrapper).addClass(i.shown).removeClass(i.hiding),e(t.errorMessage).html("<p>"+n.template(s)({limit:C})+"</p>"),e(t.save).addClass(i.disabled))},R=function(n){var i=e.Deferred();return t([n],function(){i.resolve()},function(){i.reject()}),i.promise()},{toggleExpandCollapse:a,showLoadingIndicator:r,hideLoadingIndicator:c,confirmThenRunOperation:l,runOperationShowingMessage:d,withDisabledElement:u,disableElementWhileRunning:p,deleteNotificationHandler:w,setScrollTop:m,getScrollOffset:h,setScrollOffset:f,redirect:y,reload:g,hasChangedAttributes:v,validateRequiredField:b,validateURLItemEncoding:x,validateTotalKeyLength:j,checkTotalKeyLengthViolations:k,loadJavaScript:R}})}.call(this,define||RequireJS.define,require||RequireJS.require),define("js/views/baseview",["jquery","underscore","backbone","gettext","js/utils/handle_iframe_binding","js/utils/templates","common/js/components/utils/view_utils"],function(e,t,n,i,o,s,a){var r=n.View.extend({events:{"click .ui-toggle-expansion":"toggleExpandCollapse"},options:{collapsedClass:"collapsed"},constructor:function(e){t.bindAll(this,"beforeRender","render","afterRender"),this.options&&(e=t.extend({},t.result(this,"options"),e)),this.options=e;var i=this;this.render=t.wrap(this.render,function(e,t){return i.beforeRender(),e(t),i.afterRender(),i}),n.View.prototype.constructor.apply(this,arguments)},beforeRender:function(){},render:function(){return this},afterRender:function(){o.iframeBinding(this)},toggleExpandCollapse:function(t){var n=e(t.target);t.stopPropagation(),t.preventDefault(),a.toggleExpandCollapse(n,this.options.collapsedClass)},loadTemplate:function(e){return s.loadTemplate(e)}});return r}),define("js/views/xblock_validation",["jquery","underscore","js/views/baseview","gettext"],function(e,t,n,i){var o=n.extend({initialize:function(e){n.prototype.initialize.call(this),this.template=this.loadTemplate("xblock-validation-messages"),this.root=e.root},render:function(){return this.$el.html(this.template({validation:this.model,additionalClasses:this.getAdditionalClasses(),getIcon:this.getIcon.bind(this),getDisplayName:this.getDisplayName.bind(this)})),this},getIcon:function(e){return e===this.model.ERROR?"fa-exclamation-circle":e===this.model.WARNING||e===this.model.NOT_CONFIGURED?"fa-exclamation-triangle":null},getDisplayName:function(e){return e===this.model.WARNING||e===this.model.NOT_CONFIGURED?i("Warning"):e===this.model.ERROR?i("Error"):null},getAdditionalClasses:function(){return this.root&&this.model.get("summary").type===this.model.NOT_CONFIGURED&&0===this.model.get("messages").length?"no-container-content":""}});return o}),define("js/models/xblock_validation",["backbone","gettext","underscore"],function(e,t,n){var i=e.Model.extend({defaults:{summary:{},messages:[],empty:!0,xblock_id:null},WARNING:"warning",ERROR:"error",NOT_CONFIGURED:"not-configured",parse:function(e){if(!e.empty){var i="summary"in e?e.summary:{},o="messages"in e?e.messages:[];i.text||(i.text=t("This component has validation issues.")),i.type||(i.type=this.WARNING,n.find(o,function(e){return e.type===this.ERROR?(i.type=this.ERROR,!0):!1},this)),e.summary=i,e.showSummaryOnly&&(o=[]),e.messages=o}return e}});return i}),define("js/factories/xblock_validation",["js/views/xblock_validation","js/models/xblock_validation"],function(e,t){"use strict";return function(n,i,o,s){i&&!o&&(n.showSummaryOnly=!0);var a=new t(n,{parse:!0});a.get("empty")||new e({el:s,model:a,root:o}).render()}});